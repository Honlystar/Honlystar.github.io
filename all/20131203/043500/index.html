<!DOCTYPE html>
<html lang="ZH-CN">
<head>
  <meta charset="UTF-8">
  <title>JavaScriptæ¨¡æ¿å¼•æ“åŸç†ï¼Œå‡ è¡Œä»£ç çš„äº‹å„¿ | æ˜Ÿç©ºå®ˆå€™çš„åšå®¢</title>
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1,user-scalable=0">
  <meta name="author" content="https://plus.google.com/112634278852964994392?hl=zh-cn">
  <meta name="email" content="barret.china@gmail.com">
  <meta name="description" content="æœ¬æ–‡ä¸ºå½’æ¡£å†…å®¹,åŸå§‹åœ°å€åœ¨ åšå®¢å›­.ä¸€ã€å‰è¨€ä»€ä¹ˆæ˜¯æ¨¡æ¿å¼•æ“ï¼Œè¯´çš„ç®€å•ç‚¹ï¼Œå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ‰å‡ ä¸ªå˜é‡å¾…å®šã€‚æ¯”å¦‚ï¼š1var tpl = &amp;apos;Hei, my name is &amp;lt;%name%&amp;gt;, and I\&amp;apos;m &amp;lt;%age%&amp;gt; years old.&amp;apos;;é€š">
  <meta property="og:type" content="article">
  <meta property="og:title" content="JavaScriptæ¨¡æ¿å¼•æ“åŸç†ï¼Œå‡ è¡Œä»£ç çš„äº‹å„¿ | æ˜Ÿç©ºå®ˆå€™çš„åšå®¢">
  <meta property="og:url" content="https://www.onlystar.site/all/20131203/043500/">
  <meta property="og:site_name" content="JavaScriptæ¨¡æ¿å¼•æ“åŸç†ï¼Œå‡ è¡Œä»£ç çš„äº‹å„¿">
  <meta property="og:description" content="æœ¬æ–‡ä¸ºå½’æ¡£å†…å®¹,åŸå§‹åœ°å€åœ¨ åšå®¢å›­.ä¸€ã€å‰è¨€ä»€ä¹ˆæ˜¯æ¨¡æ¿å¼•æ“ï¼Œè¯´çš„ç®€å•ç‚¹ï¼Œå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ‰å‡ ä¸ªå˜é‡å¾…å®šã€‚æ¯”å¦‚ï¼š1var tpl = &amp;apos;Hei, my name is &amp;lt;%name%&amp;gt;, and I\&amp;apos;m &amp;lt;%age%&amp;gt; years old.&amp;apos;;é€š">
  <meta name="generator" content="https://hexo.io" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="renderer" content="webkit">
  <link href="https://www.onlystar.site/blogimgs/app-icon.png" rel="apple-touch-icon-precomposed">
  <link rel="shoticon" href="https://www.onlystar.site/favicon.ico" type="image/x-icon">
  <link rel="alternate" type="application/rss+xml" href="https://www.onlystar.site/rss2.xml" title="æ˜Ÿç©ºå®ˆå€™çš„åšå®¢" />
  <link rel="prev" href="https://www.onlystar.site/all/20131206/101400/" title="PJAXçš„å®ç°ä¸åº”ç”¨" />
  <link rel="next" href="https://www.onlystar.site/all/20131128/094600/" title="ECMAScript 6ä¸­çš„letå’Œconstå…³é”®è¯" />
  <link rel="start" href="https://www.onlystar.site/entry/" title="Blog Entry" />
  <link rel="stylesheet" href="/public/css/style.css?v=20170604">
</head>
<span class="aria-readonly" tabindex="0" aria-hidden="true">å°èƒ¡å­å“¥çš„åšå®¢è‰¯å¥½æ”¯æŒè¯»å±è½¯ä»¶é˜…è¯»ï¼Œè¯·æ”¾å¿ƒä½¿ç”¨ã€‚</span>


<body>
  <div class="rainbow"></div>
  <div class="container">
  <span class="local-search local-search-google local-search-plugin" style="position:absolute;right: 20px;top:30px;">
  <input type="search" placeholder="ç«™å†…æœç´¢" id="local-search-input" class="local-search-input-cls" style="">
  <i class="icon" aria-hidden="true" title="ç‚¹å‡»è¿›å…¥ Google æœç´¢">&#x2708;</i>
  <div id="local-search-result" class="local-search-result-cls"></div>
</span>
  <div class="article" itemscope itemtype="http://schema.org/Article">
    <div class="post">
      <div class="bread">
        <a href="/">å°èƒ¡å­å“¥çš„ä¸ªäººåšå®¢</a> Â»
        <a href="/entry/">åšå®¢</a> Â»
        
	<a class="category-link" href="/categories/JavaScript/">JavaScript</a>,<a class="category-link" href="/categories/JavaScript/å‰ç«¯æ‚çƒ©/">å‰ç«¯æ‚çƒ©</a>


      </div>
      <div class="post-title-wrapper">
        <h1 class="post-title" itemprop="name">JavaScriptæ¨¡æ¿å¼•æ“åŸç†ï¼Œå‡ è¡Œä»£ç çš„äº‹å„¿<img src="https://game.weixin.qq.com/cgi-bin/comm/qrcode?s=50&m=1&d=http:https://www.onlystar.site/all/20131203/043500/" alt="æ‰«ç åˆ†äº«" onerror="this.style.display='none';"></h1>
        <a href="/about/"><img src="/blogimgs/avatar.png" alt="rain" /></a>
      </div>
      <div class="post-info">
        <span>ä½œè€…: <a href="/about/">rain</a></span>
        <span>
          <time itemprop="timeCreated" aria-hidden="true">2013-12-03 04:35:00</time>
          <span class="aria-readonly">æœ¬æ–‡å‘å¸ƒæ—¶é—´ä¸º2013å¹´12æœˆ03æ—¥04æ—¶35åˆ†00ç§’</span>
        </span>
        <span>åˆ†ç±»: 
	<a class="category-link" href="/categories/JavaScript/">JavaScript</a>,<a class="category-link" href="/categories/JavaScript/å‰ç«¯æ‚çƒ©/">å‰ç«¯æ‚çƒ©</a>

</span>
        <span tabindex="0" aria-hidden="true">æ ‡ç­¾: 
<a class="article-tag-link" href="/tags/cnblogs/">cnblogs</a>, <a class="article-tag-link" href="/tags/tech/">tech</a>
</span>
        <span class="aria-readonly">ä¸‹é¢æ˜¯æ­£æ–‡å†…å®¹</span>
        <span tabindex="0" aria-hidden="true">è¯„è®ºæ•°: <a href="#comments"
                      class="ds-thread-count hash-to-comments disqus-comment-count"
                      data-thread-key="cb-principle-of-javascript-template"
                      data-disqus-identifier="cb-principle-of-javascript-template"
                      id="changyan_count_unit"></a></span>
        <span tabindex="0" aria-hidden="true" id="busuanzi_container_site_pv">çƒ­åº¦: <span id="busuanzi_value_page_pv"></span></span>
      </div>
      <div class="post-content" itemprop="articleBody">
        <div class="shit-spider" title="é˜²çˆ¬è™«ä¸æ³¨æ˜å‡ºå¤„" tabindex="0" aria-hidden="true">
          <p>åŸæ–‡åœ°å€ï¼š<a href="https://www.onlystar.site/all/20131203/043500/">https://www.onlystar.site/all/20131203/043500/</a>ï¼Œ<a href="https://www.onlystar.site/all/20131203/043500/#comments">å‚ä¸è¯„è®º</a></p>
          <img src="//www.barretlee.com/blogimgs/avatar.png" width="150">
        </div>
        <div class="history-article">æœ¬æ–‡ä¸ºå½’æ¡£å†…å®¹,åŸå§‹åœ°å€åœ¨ <a href="http://www.cnblogs.com/hustskyking/archive/2013/12/03/principle-of-javascript-template.html" target="_blank">åšå®¢å›­</a>.</div>

<p></p><h3>ä¸€ã€å‰è¨€</h3><p></p>
<p>ä»€ä¹ˆæ˜¯æ¨¡æ¿å¼•æ“ï¼Œè¯´çš„ç®€å•ç‚¹ï¼Œå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ‰å‡ ä¸ªå˜é‡å¾…å®šã€‚æ¯”å¦‚ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var tpl = &apos;Hei, my name is &lt;%name%&gt;, and I\&apos;m &lt;%age%&gt; years old.&apos;;</div></pre></td></tr></table></figure>
<p>é€šè¿‡æ¨¡æ¿å¼•æ“å‡½æ•°æŠŠæ•°æ®å¡è¿›å»ï¼Œ</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var data = &#123;</div><div class="line">    &quot;name&quot;: &quot;Barret Lee&quot;,</div><div class="line">    &quot;age&quot;: &quot;20&quot;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">var result = tplEngine(tpl, data);</div><div class="line">//Hei, my name is Barret Lee, and I&apos;m 20 years old.</div></pre></td></tr></table></figure>
<p>é‚£è¿™ç©æ„å„¿æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿå…¶å®ä»–å°±æ˜¯ä¸€ä¸ªé¢„å¤„ç†å™¨ï¼ˆpreprocessorï¼‰ï¼Œæphpå¼€å‘çš„ç«¥é‹å¯¹Smartyå¿…ç„¶æ˜¯ååˆ†ç†Ÿæ‚‰ï¼ŒSmartyæ˜¯ä¸€ä¸ªphpæ¨¡æ¿å¼•æ“ï¼Œtplä¸­å¾…å¤„ç†çš„å­—ç¬¦é€šè¿‡æ•°æ®åŒ¹é…ç„¶åè¾“å‡ºç›¸åº”çš„htmlä»£ç ï¼ŒåŠ ä¹‹æ¯”è¾ƒç»™åŠ›çš„ç¼“å­˜æŠ€æœ¯ï¼Œå…¶é€Ÿåº¦å’Œæ˜“ç”¨æ€§æ˜¯éå¸¸ç»™åŠ›çš„ï¼JS Templateä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬çš„æ•°æ®åº“é‡Œä¿å­˜ç€æ•°ä»¥åƒä¸‡è®¡çš„æ•°æ®ï¼Œè€Œæ¯ä¸€æ¡æ•°æ®éƒ½æ˜¯é€šè¿‡åŒä¸€ç§æ–¹å¼è¾“å…¥ï¼Œå°±æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œæˆ‘ä»¬ä¸å¯èƒ½åœ¨æ•°æ®åº“é‡Œå­˜å‡ åƒæ¡â€Hei, my nameâ€¦â€ï¼Œè€Œæ˜¯åªä¿å­˜å¯¹åº”çš„nameå’Œageï¼Œé€šè¿‡æ¨¡æ¿è¾“å‡ºç»“æœã€‚</p><br><p>JSæ¨¡æ¿å¼•æ“åº”è¯¥åšå“ªäº›äº‹æƒ…ï¼Ÿçœ‹çœ‹ä¸‹é¢ä¸€ä¸²ä»£ç ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var tpl = &apos;&lt;% for(var i = 0; i &lt; this.posts.length; i++) &#123;&apos; +ã€€</div><div class="line">    &apos;var post = posts[i]; %&gt;&apos; +</div><div class="line">    &apos;&lt;% if(!post.expert)&#123; %&gt;&apos; +</div><div class="line">        &apos;&lt;span&gt;post is null&lt;/span&gt;&apos; +</div><div class="line">    &apos;&lt;% &#125; else &#123; %&gt;&apos; +</div><div class="line">        &apos;&lt;a href=&quot;#&quot;&gt;&lt;% post.expert %&gt; at &lt;% post.time %&gt;&lt;/a&gt;&apos; +</div><div class="line">    &apos;&lt;% &#125; %&gt;&apos; +</div><div class="line">&apos;&lt;% &#125; %&gt;&apos;;</div></pre></td></tr></table></figure>
<p><span>ä¸€ä¸ªåŸºæœ¬çš„æ¨¡æ¿å¼•æ“è‡³å°‘å¯ä»¥ä¿è¯ä¸Šé¢çš„ä»£ç å¯ä»¥æ­£å¸¸è§£æã€‚å¦‚é€å…¥çš„æ•°æ®æ˜¯ï¼š</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">var data = &#123;</div><div class="line">    &quot;posts&quot;: [&#123;</div><div class="line">        &quot;expert&quot;: &quot;content 1&quot;,</div><div class="line">        &quot;time&quot;: &quot;yesterday&quot;</div><div class="line">    &#125;,&#123;</div><div class="line">        &quot;expert&quot;: &quot;content 2&quot;,</div><div class="line">        &quot;time&quot;: &quot;today&quot;</div><div class="line">    &#125;,&#123;</div><div class="line">        &quot;expert&quot;: &quot;content 3&quot;,</div><div class="line">        &quot;time&quot;: &quot;tomorrow&quot;</div><div class="line">    &#125;,&#123;</div><div class="line">        &quot;expert&quot;: &quot;&quot;,</div><div class="line">        &quot;time&quot;: &quot;eee&quot;</div><div class="line">    &#125;]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>&nbsp;å¯ä»¥è¾“å‡ºï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;#&quot;&gt;content 1 at yesterday&lt;/a&gt;</div><div class="line">&lt;a href=&quot;#&quot;&gt;content 2 at today&lt;/a&gt;</div><div class="line">&lt;a href=&quot;#&quot;&gt;content 3 at tomorrow&lt;/a&gt;</div><div class="line">&lt;span&gt;post is null&lt;/span&gt;</div></pre></td></tr></table></figure>
<p><span>å…ˆæˆ³è¿™ä¸ª</span><a href="http://qianduannotes.duapp.com/demo/javascript-template.html" target="_blank">demo</a>çœ‹çœ‹<span>ã€‚</span>&nbsp;</p><br><p>ä¸‹é¢å°±å…·ä½“è¯´è¯´è¿™ä¸ªæ¨¡æ¿å¼•æ“çš„åŸç†æ˜¯å•¥æ ·çš„ã€‚</p>


<p></p><h3>äºŒã€JSæ¨¡æ¿å¼•æ“çš„å®ç°åŸç†</h3><p></p>
<h4><strong>1.æ­£åˆ™æŠ å‡ºè¦åŒ¹é…çš„å†…å®¹</strong></h4><br><p>é’ˆå¯¹è¿™ä¸€ä¸²ä»£ç ï¼Œé€šè¿‡æ­£åˆ™è·å–å†…å®¹</p><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var tpl = &apos;Hei, my name is &lt;%name%&gt;, and I\&apos;m &lt;%age%&gt; years old.&apos;;</div><div class="line">var data = &#123;</div><div class="line">    &quot;name&quot;: &quot;Barret Lee&quot;,</div><div class="line">    &quot;age&quot;: &quot;20&quot;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><br><br><p>&nbsp;æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯é€šè¿‡replaceå‡½æ•°äº†ï¼š</p><br><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var result = tpl.replace(/&lt;%([^%&gt;]+)?%&gt;/g, function(s0, s1)&#123;</div><div class="line">    return data[s1];</div><div class="line">&#125;);</div></pre></td></tr></table></figure><br><br><p>&nbsp;é€šè¿‡æ­£åˆ™æ›¿æ¢ï¼Œæˆ‘ä»¬å¾ˆè½»æ¾çš„æ‹¿åˆ°äº†resultï¼Œä½ å¯ä»¥å»è¯•ä¸€è¯•ï¼Œä»–æ­£å¼æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚ä½†æ˜¯è¿™é‡Œåˆæœ‰äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ”¹ä¸€ä¸‹dataå’Œtplï¼Œ</p><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var tpl = &apos;Hei, my name is &lt;%name%&gt;, and I\&apos;m &lt;%info.age%&gt; years old.&apos;;</div><div class="line">var data = &#123;</div><div class="line">    &quot;name&quot;: &quot;Barret Lee&quot;,</div><div class="line">    &quot;info&quot;: &#123; age&quot;: &quot;20&quot;&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><br><br><p>&nbsp;å†ç”¨ä¸Šé¢çš„æ–¹å¼å»è·å–ç»“æœï¼Œå‘µå‘µï¼Œä¸è¡Œäº†å§~ è¿™é‡Œdata[â€œinfo.ageâ€]æœ¬èº«å°±æ˜¯undefinedï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ¢ä¸€ç§æ–¹å¼æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯å°†å®ƒè½¬æ¢æˆçœŸæ­£çš„JSä»£ç ã€‚å¦‚ï¼š</p><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return &apos;Hei, my name is &apos; + data.name + &apos;, and I\&apos;m &apos; + data.info.age&apos; + &apos; years old.&apos;</div></pre></td></tr></table></figure><br><br><p>&nbsp;ä½†æ˜¯æ¥ç€åˆæœ‰ä¸€ä¸ªé—®é¢˜æ¥äº†ï¼Œå½“æˆ‘ä»¬çš„ä»£ç ä¸­å‡ºç°forå¾ªç¯å’Œifçš„æ—¶å€™ï¼Œä¸Šé¢çš„è½¬æ¢æ˜æ˜¾æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œå¦‚ï¼š</p><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var tpl = &apos;Posts: &apos; +</div><div class="line">          &apos;&lt;% for(var=&quot;&quot; i=&quot;0;&quot; &lt;=&quot;&quot; post.length;=&quot;&quot; i++)=&quot;&quot; &#123;&apos;+=&quot;&quot; &apos;&lt;a=&quot;&quot; href=&quot;#&quot;&gt;&lt;% post[i].expert=&quot;&quot; %=&quot;&quot;&gt;&apos; +</div><div class="line">          &apos;&lt;% &#125;=&quot;&quot; %=&quot;&quot;&gt;&apos;</div></pre></td></tr></table></figure><br><br><p>&nbsp;å¦‚æœç»§ç»­é‡‡ç”¨ä¸Šé¢çš„æ–¹å¼ï¼Œå¾—åˆ°çš„ç»“æœä¾¿æ˜¯ï¼š</p><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">return &apos;Posts: &apos; +</div><div class="line">       for(var i = 0; i &lt; post.length; i++) &#123; +</div><div class="line">         &apos;&lt;a href=&quot;#&quot;&gt;&apos; + post[i].exper + &apos;&lt;/a&gt;&apos; +</div><div class="line">       &#125;</div></pre></td></tr></table></figure><br><br><p>&nbsp;è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æ„¿æ„çœ‹åˆ°çš„ï¼Œç¨å¾®è§‚å¯Ÿä¸€ä¸‹ä¸Šé¢çš„ç»“æ„ï¼Œå¦‚æœå¯ä»¥è¿”å›ä¸€ä¸ªè¿™æ ·çš„ç»“æœä¹ŸæŒºä¸é”™å“¦ï¼š</p><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&apos;Posts: &apos;</div><div class="line">for(var i = 0; i &lt; post.length; i++) &#123;</div><div class="line">    &apos;&lt;a href=&quot;#&quot;&gt;&apos; + post[i].exper + &apos;&lt;/a&gt;&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure><br><br><p>&nbsp;ä½†æ˜¯æˆ‘ä»¬éœ€è¦å¾—åˆ°çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ä¸Šé¢è¿™æ ·é›¶æ•£çš„ç‰‡æ®µï¼Œå› æ­¤å¯ä»¥æŠŠè¿™äº›ä¸œè¥¿è£…å…¥æ•°ç»„ä¸­ã€‚</p><br><h4>2.è£…å…¥æ•°ç»„</h4>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var r = [];</div><div class="line">r.push(&apos;Posts: &apos; );</div><div class="line">r.push(for(var i = 0; i &lt; post.length; i++) &#123;);</div><div class="line">r.push(&apos;&lt;a href=&quot;#&quot;&gt;&apos;);</div><div class="line">r.push(post[i].exper);</div><div class="line">r.push(&apos;&lt;/a&gt;&apos;);</div><div class="line">r.push(&#125;);</div></pre></td></tr></table></figure>
<p>&nbsp;æœ‰äººçœ‹åˆ°ä¸Šé¢çš„ä»£ç å°±è¦ç¬‘äº†ï¼Œç¬¬ä¸‰è¡Œå’Œæœ€åä¸€è¡Œä»£ç çš„é€»è¾‘æ˜æ˜¾æ˜¯ä¸æ­£ç¡®çš„å˜›ï¼Œé‚£è‚¿ä¹ˆåŠå‘¢ï¼Ÿå‘µå‘µï¼Œå¾ˆç®€å•ï¼Œä¸æ”¾è¿›å»å°±è¡Œäº†å‘—ï¼Œ</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var r = [];</div><div class="line">r.push(&apos;Posts: &apos; );</div><div class="line">for(var i = 0; i &lt; post.length; i++) &#123;</div><div class="line">    r.push(&apos;&lt;a href=&quot;#&quot;&gt;&apos;);</div><div class="line">    r.push(post[i].exper);</div><div class="line">    r.push(&apos;&lt;/a&gt;&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>&nbsp;è¿™æ ·çš„é€»è¾‘å°±ååˆ†å®Œå–„äº†ï¼Œä¸å­˜åœ¨å¤ªå¤šçš„æ¼æ´ï¼Œä½†æ˜¯è¿™ä¸ªè½¬åŒ–çš„è¿‡ç¨‹æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿæˆ‘ä»¬å¿…é¡»è¿˜æ˜¯è¦å†™ä¸€ä¸ªè§£æçš„æ¨¡æ¿å‡½æ•°å‡ºæ¥ã€‚</p><br><h4>3.åˆ†è¾¨jsé€»è¾‘éƒ¨åˆ†</h4><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var r = [];</div><div class="line">tpl.replace(/&lt;%([^%&gt;]+)?%&gt;/g, function(s0, s1)&#123;</div><div class="line">    //å®Œè›‹äº†ï¼Œè¿™é‡Œè²Œä¼¼åˆè¦å›åˆ°ä¸Šé¢é‚£å¯ç¬‘çš„é€»è¾‘æœ‰é”™è¯¯çš„ä¸€æ­¥å•¦... è¯¥æ€ä¹ˆå¤„ç†æ¯”è¾ƒå¥½ï¼Ÿ</div><div class="line">&#125;);</div></pre></td></tr></table></figure><br><br><p>&nbsp;å®Œè›‹äº†ï¼Œè¿™é‡Œè²Œä¼¼åˆè¦å›åˆ°ä¸Šé¢é‚£å¯ç¬‘çš„é€»è¾‘æœ‰é”™è¯¯çš„ä¸€æ­¥å•¦â€¦ è¯¥æ€ä¹ˆå¤„ç†æ¯”è¾ƒå¥½ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼ŒJSç»™æˆ‘ä»¬æä¾›äº†æ„é€ å‡½æ•°çš„\ç±»â€ï¼Œ</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var fn = new Function(&quot;data&quot;,</div><div class="line">    &quot;var r = []; for(var i in data)&#123; r.push(data[i]); &#125; return r.join(&apos; &apos;)&quot;);</div><div class="line">fn(&#123;&quot;name&quot;: &quot;barretlee&quot;, &quot;age&quot;: &quot;20&quot;&#125;); // barretlee 20</div></pre></td></tr></table></figure>
<p>&nbsp;çŸ¥é“äº†è¿™ä¸ªå°±å¥½åŠäº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé€»è¾‘éƒ¨åˆ†å’Œéé€»è¾‘éƒ¨åˆ†çš„ä»£ç é“¾æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶ååˆ©ç”¨ç±»ä¼¼fnçš„å‡½æ•°ç›´æ¥ç¼–è¯‘ä»£ç ã€‚è€Œ<code>/&lt;%([^%&gt;]+)?%&gt;/g</code>ï¼Œè¿™ä¸€ä¸ªæ­£åˆ™åªèƒ½æŠŠé€»è¾‘éƒ¨åˆ†åŒ¹é…å‡ºæ¥ï¼Œè¦æƒ³æŠŠæ‰€æœ‰çš„ä»£ç éƒ½ç»„åˆåˆ°ä¸€èµ·ï¼Œå¿…é¡»è¿˜å¾—åŒ¹é…éé€»è¾‘éƒ¨åˆ†ä»£ç ã€‚replaceå‡½æ•°è™½ç„¶å¾ˆå¼ºå¤§ï¼Œä»–ä¹Ÿå¯ä»¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œä½†æ˜¯å®ç°çš„é€»è¾‘æ¯”è¾ƒæ™¦æ¶©ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¢å¦å¤–ä¸€ç§æ–¹å¼æ¥å¤„ç†ã€‚</p><br><p>å…ˆçœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var reg = /&lt;%([^%&gt;]+)?%&gt;/g;</div><div class="line">var tpl = &apos;Hei, my name is &lt;%name%&gt;, and I\&apos;m &lt;%age%&gt; years old.&apos;;</div><div class="line">var match = reg.exec(tpl);</div><div class="line">console.log(match);</div></pre></td></tr></table></figure>
<p>&nbsp;çœ‹åˆ°çš„æ˜¯ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">    0: &quot;&lt;%name%&gt;&quot;,</div><div class="line">    1: name,</div><div class="line">    index: 16,</div><div class="line">    input: &quot;Hei, my name is &lt;%name%&gt;, and I&apos;m &lt;%age%&gt; years old.&quot;</div><div class="line">    length: 2</div><div class="line">]</div></pre></td></tr></table></figure>
<p>&nbsp;è¿™ã€‚ã€‚ã€‚æˆ‘ä»¬å¯æ˜¯æƒ³å¾—åˆ°æ‰€æœ‰çš„åŒ¹é…å•Šï¼Œä»–ç«Ÿç„¶åªè·å–äº†nameè€Œå¿½ç•¥äº†åé¢çš„ageï¼Œå¥½å§ï¼Œå¯¹æ­£åˆ™ç¨å¾®ç†Ÿæ‚‰ç‚¹çš„ç«¥é‹ä¸€å®šä¼šçŸ¥é“åº”è¯¥è¿™æ ·å¤„ç†ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var reg = /&lt;%([^%&gt;]+)?%&gt;/g;</div><div class="line">while(match = reg.exec(tpl)) &#123;</div><div class="line">    console.log(match);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>&nbsp;å…³äºæ­£åˆ™è¡¨è¾¾å¼çš„å†…å®¹å°±ä¸åœ¨è¿™é‡Œç»†è¯´äº†ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å¤šå»äº†è§£ä¸‹match,exec,searchç­‰æ­£åˆ™çš„ç›¸å…³å‡½æ•°ã€‚è¿™é‡Œä¸»è¦æ˜¯é matchçš„indexå±æ€§æ¥å®šä½éå†ä½ç½®ï¼Œç„¶ååˆ©ç”¨whileå¾ªç¯è·å–æ‰€æœ‰çš„å†…å®¹ã€‚</p><br><h4>4.å¼•æ“å‡½æ•°</h4><br><p>æ‰€ä»¥æˆ‘ä»¬çš„å¼•æ“å‡½æ•°é›å½¢å·®ä¸å¤šå°±å‡ºæ¥äº†ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">var tplEngine = function(tpl, data)&#123;</div><div class="line">    var reg = /&lt;%([^%&gt;]+)?%&gt;/g,</div><div class="line">            code = &apos;var r=[];\n&apos;,</div><div class="line">            cursor = 0;  //ä¸»è¦çš„ä½œç”¨æ˜¯å®šä½ä»£ç æœ€åä¸€æˆª</div><div class="line">    var add = function(line) &#123;</div><div class="line">        code += &apos;r.push(&quot;&apos; + line.replace(/&quot;/g, &apos;\\&quot;&apos;) + &apos;&quot;);\n&apos;;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    while(match = reg.exec(tpl)) &#123;</div><div class="line">        add(tpl.slice(cursor, match.index)); //æ·»åŠ éé€»è¾‘éƒ¨åˆ†</div><div class="line">        add(match[1]);  //æ·»åŠ é€»è¾‘éƒ¨åˆ† match[0] = &quot;&lt;%&quot; +=&quot;&quot; match[1]=&quot;&quot; &quot;%=&quot;&quot;&gt;&quot;;</div><div class="line">        cursor = match.index + match[0].length;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    add(tpl.substr(cursor, tpl.length - cursor)); //ä»£ç çš„æœ€åä¸€æˆª å¦‚:&quot; years old.&quot;</div><div class="line"></div><div class="line">    code += &apos;return r.join(&quot;&quot;);&apos;; // è¿”å›ç»“æœï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°±æ‹¿åˆ°äº†è£…å…¥æ•°ç»„åçš„ä»£ç </div><div class="line">    console.log(code);</div><div class="line"></div><div class="line">    return tpl;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>&nbsp;è¿™æ ·ä¸€æ¥ï¼Œæµ‹è¯•ä¸€ä¸ªå°demo:</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"> var tpl = &apos;&lt;% for(var=&quot;&quot; i=&quot;0;&quot; &lt;=&quot;&quot; this.posts.length;=&quot;&quot; i++)=&quot;&quot; &#123;&apos;=&quot;&quot; +ã€€=&quot;&quot; &apos;var=&quot;&quot; post=&quot;posts[i];&quot; %=&quot;&quot;&gt;&apos; +</div><div class="line">        &apos;&lt;% if(!post.expert)&#123;=&quot;&quot; %=&quot;&quot;&gt;&apos; +</div><div class="line">            &apos;&lt;span&gt;post is null&lt;/span&gt;&apos; +</div><div class="line">        &apos;&lt;% &#125;=&quot;&quot; else=&quot;&quot; &#123;=&quot;&quot; %=&quot;&quot;&gt;&apos; +</div><div class="line">            &apos;&lt;a href=&quot;#&quot;&gt;&lt;% post.expert=&quot;&quot; %=&quot;&quot;&gt; at &lt;% post.time=&quot;&quot; %=&quot;&quot;&gt;&lt;/%&gt;&lt;/%&gt;&lt;/a&gt;&apos; +</div><div class="line">        &apos;&lt;% &#125;=&quot;&quot; %=&quot;&quot;&gt;&apos; +</div><div class="line">    &apos;&lt;% &#125;=&quot;&quot; %=&quot;&quot;&gt;&apos;;</div><div class="line">tplEngine(tpl, data);</div></pre></td></tr></table></figure>
<p>&nbsp;è¿”å›çš„ç»“æœè®©äººå¾ˆæ»¡æ„ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">var r=[];</div><div class="line">r.push(&quot;&quot;);</div><div class="line">r.push(&quot; for(var i = 0; i &lt; this.posts.length; i++) &#123;var post = posts[i]; &quot;);</div><div class="line">r.push(&quot;&quot;);</div><div class="line">r.push(&quot; if(!post.expert)&#123; &quot;);</div><div class="line">r.push(&quot;&lt;span&gt;post is null&lt;/span&gt;&quot;);</div><div class="line">r.push(&quot; &#125; else &#123; &quot;);</div><div class="line">r.push(&quot;&lt;a href=&quot;\&quot;#\&quot;&quot;&gt;&quot;);</div><div class="line">r.push(&quot; post.expert &quot;);</div><div class="line">r.push(&quot; at &quot;);</div><div class="line">r.push(&quot; post.time &quot;);</div><div class="line">r.push(&quot;&lt;/a&gt;&quot;);</div><div class="line">r.push(&quot; &#125; &quot;);</div><div class="line">r.push(&quot;&quot;);</div><div class="line">r.push(&quot; &#125; &quot;);</div><div class="line">r.push(&quot;&quot;);</div><div class="line">return r.join(&quot;&quot;);</div></pre></td></tr></table></figure>
<p>&nbsp;ä¸è¿‡æˆ‘ä»¬å¹¶éœ€è¦forï¼Œifï¼Œswitchç­‰è¿™äº›ä¸œè¥¿ä¹Ÿpushåˆ°ræ•°ç»„ä¸­å»ï¼Œæ‰€ä»¥å‘¢ï¼Œè¿˜å¾—æ”¹å–„ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œå¦‚æœåœ¨lineä¸­å‘ç°äº†åŒ…å«jsé€»è¾‘çš„ä»£ç ï¼Œæˆ‘ä»¬å°±ä¸åº”è¯¥è®©ä»–è¿›é—¨ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">regOut = /(^( )?(if|for|else|switch|case|break|&#123;|&#125;))(.*)?/g;</div><div class="line">var add = function(line, js) &#123;</div><div class="line">    js? code += line.match(regOut) ? line + &apos;\n&apos; : &apos;r.push(&apos; + line + &apos;);\n&apos; :</div><div class="line">        code += &apos;r.push(&quot;&apos; + line.replace(/&quot;/g, &apos;\\&quot;&apos;) + &apos;&quot;);\n&apos;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>&nbsp;æ‰€ä»¥æˆ‘ä»¬åªå‰©ä¸‹æœ€åä¸€æ­¥å·¥ä½œäº†ï¼ŒæŠŠdataæ‰”è¿›å»ï¼</p><br><h4>5.æŠŠdataæ‰”è¿›å»</h4><br><p>æ²¡æœ‰æ¯”å®Œæˆè¿™ä¸œè¥¿æ›´ç®€å•çš„äº‹æƒ…å•¦ï¼Œé€šè¿‡ä¸Šé¢å¯¹Functionè¿™ä¸ªå‡½æ•°çš„è®²è§£ï¼Œå¤§å®¶åº”è¯¥ä¹ŸçŸ¥é“æ€ä¹ˆåšäº†ã€‚</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return new Function(code).apply(data);</div></pre></td></tr></table></figure>
<p>&nbsp;ä½¿ç”¨applyçš„ä½œç”¨å°±æ˜¯è®©codeä¸­çš„ä¸€äº›å˜é‡ä½œç”¨åŸŸç»‘å®šåˆ°dataä¸Šï¼Œä¸ç„¶ä½œç”¨åŸŸå°±ä¼šè·‘åˆ°globalä¸Šï¼Œè¿™æ ·å¾—åˆ°çš„æ•°æ®ç´¢å¼•å°±ä¼šå‡ºé—®é¢˜å•¦~ å½“ç„¶æˆ‘ä»¬å¯ä»¥å†ä¼˜åŒ–ä¸€ä¸‹ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return new Function(code.replace(/[\r\t\n]/g, &apos;&apos;)).apply(data);</div></pre></td></tr></table></figure>
<p>&nbsp;æŠŠå›è½¦æ¢è¡Œä»¥åŠtabé”®éƒ½ç»™åŒ¹é…æ‰ï¼Œè®©ä»£ç æ›´åŠ å¹²å‡€ä¸€ç‚¹ã€‚é‚£ä¹ˆæœ€ç»ˆçš„ä»£ç å°±æ˜¯ï¼š</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">var tplEngine = function(tpl, data) &#123;</div><div class="line">    var reg = /&lt;%([^%&gt;]+)?%&gt;/g,</div><div class="line">        regOut = /(^( )?(if|for|else|switch|case|break|&#123;|&#125;))(.*)?/g,</div><div class="line">        code = &apos;var r=[];\n&apos;,</div><div class="line">        cursor = 0;</div><div class="line"></div><div class="line">    var add = function(line, js) &#123;</div><div class="line">        js? (code += line.match(regOut) ? line + &apos;\n&apos; : &apos;r.push(&apos; + line + &apos;);\n&apos;) :</div><div class="line">            (code += line != &apos;&apos; ? &apos;r.push(&quot;&apos; + line.replace(/&quot;/g, &apos;\\&quot;&apos;) + &apos;&quot;);\n&apos; : &apos;&apos;);</div><div class="line">        return add;</div><div class="line">    &#125;</div><div class="line">    while(match = reg.exec(tpl)) &#123;</div><div class="line">        add(tpl.slice(cursor, match.index))(match[1], true);</div><div class="line">        cursor = match.index + match[0].length;</div><div class="line">    &#125;</div><div class="line">    add(tpl.substr(cursor, tpl.length - cursor));</div><div class="line">    code += &apos;return r.join(&quot;&quot;);&apos;;</div><div class="line">    return new Function(code.replace(/[\r\t\n]/g, &apos;&apos;)).apply(data);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p></p><h3>ä¸‰ã€åº”ç”¨åœºæ™¯</h3><p></p>
<p>æ¯•ç«Ÿæ˜¯å‰ç«¯ä»£ç ï¼Œæ‰€ä»¥å†™å‡ºæ¥æ˜¯è¦ä¸ºå‰ç«¯æœåŠ¡çš„ï¼Œå¹³æ—¶æˆ‘ä»¬å¤„ç†çš„ä¸€èˆ¬æ˜¯ä¸€ä¸ªhtmlçš„æ¨¡æ¿ï¼Œé€šå¸¸çš„æƒ…å†µä¸‹ï¼Œæ¨¡æ¿ä»£ç æ˜¯æ”¾åœ¨scriptæ ‡ç­¾æˆ–è€…textareaä¸­ï¼Œæ‰€ä»¥é¦–å…ˆæ˜¯è¦è·å–åˆ°è¿™é‡Œå¤´çš„ä¸œè¥¿ï¼Œç„¶åå†æ¥åšè§£æã€‚</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">var barretTpl = function(str, data) &#123;</div><div class="line"></div><div class="line">    //è·å–å…ƒç´ </div><div class="line">    var element = document.getElementById(str);</div><div class="line">    if (element) &#123;</div><div class="line">        //textareaæˆ–inputåˆ™å–valueï¼Œå…¶å®ƒæƒ…å†µå–innerHTML</div><div class="line">        var html = /^(textarea|input)$/i.test(element.nodeName) ? element.value : element.innerHTML;</div><div class="line">        return tplEngine(html, data);</div><div class="line">    &#125; else &#123;</div><div class="line">        //æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œåˆ™ç”Ÿæˆä¸€ä¸ªå‡½æ•°</div><div class="line">        //å¦‚æœç›´æ¥ä¼ å…¥å­—ç¬¦ä¸²ä½œä¸ºæ¨¡æ¿ï¼Œåˆ™å¯èƒ½å˜åŒ–è¿‡å¤šï¼Œå› æ­¤ä¸è€ƒè™‘ç¼“å­˜</div><div class="line">        return tplEngine(str, data);</div><div class="line">    &#125;</div><div class="line">    var tplEngine = function(tpl, data) &#123;</div><div class="line">        // content above</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>è¿™æ ·ä¸€æ¥å°±æ›´åŠ ç®€å•äº†ï¼Œä½¿ç”¨æ–¹å¼å°±æ˜¯ <code>barretTpl(str, data)</code>ï¼Œ è¿™é‡Œçš„strå¯ä»¥æ˜¯æ¨¡æ¿ä»£ç ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªDOMå…ƒç´ çš„id~ å¯ä»¥çœ‹çœ‹è¿™ä¸¤æ®µä»£ç ï¼š<a href="//gist.github.com/barretlee/7765698" target="_blank">//gist.github.com/barretlee/7765698</a>, <a href="//gist.github.com/barretlee/7765587" target="_blank">//gist.github.com/barretlee/7765587</a></p><br><p>ä¹Ÿå¯ä»¥ç›´æ¥æˆ³è¿™ä¸ª<a href="http://qianduannotes.duapp.com/demo/javascript-template.html" target="_blank">demo</a>ã€‚</p>


<p></p><h3>å››ã€ä¼˜åŒ–ä»¥åŠåŠŸèƒ½æ‹“å±•</h3><p></p>
<p>æ€»å…±å°±ä¸‰å››åè¡Œä»£ç ï¼Œå®Œæˆçš„ä¸œè¥¿è‚¯å®šæ˜¯ä¸€ä¸ªç®€æ´ç‰ˆçš„ï¼Œä¸è¿‡å¯¹äºä¸€ä¸ªç®€å•çš„é¡µé¢è€Œè¨€ï¼Œè¿™å‡ è¡Œä»£ç å·²ç»è¶³å¤Ÿä½¿ç”¨äº†ï¼Œå¦‚æœè¿˜æƒ³å¯¹ä»–åšä¼˜åŒ–ï¼Œå¯ä»¥ä»è¿™å‡ ä¸ªæ–¹é¢è€ƒè™‘ï¼š</p><br><ul><br><li>ä¼˜åŒ–è·å–çš„æ¨¡æ¿ä»£ç ï¼Œæ¯”å¦‚å»æ‰è¡Œå°¾ç©ºæ ¼ç­‰</li><br><li>ç¬¦å·è½¬ä¹‰ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¾“å‡º<code>&lt;span&gt;hehe&lt;/span&gt;</code>ç±»ä¼¼è¿™æ ·çš„æºä»£ç ï¼Œåœ¨pushä¹‹å‰å¿…é¡»è¿›è¡Œè½¬ä¹‰</li><br><li>ä»£ç ç¼“å­˜ï¼Œå¦‚æœä¸€ä¸ªæ¨¡æ¿ä¼šç»å¸¸ä½¿ç”¨ï¼Œå¯ä»¥å°†å®ƒç”¨ä¸€ä¸ªæ•°ç»„ç¼“å­˜åœ¨barretTplé—­åŒ…å†…</li><br><li>ç”¨æˆ·è‡ªå·±è®¾ç½®åˆ†éš”ç¬¦</li><br></ul><br><br><br><h3>äº”ã€å‚è€ƒèµ„æ–™</h3><br><p>[1]&nbsp;<a href="http://tech.pro/tutorial/1743/javascript-template-engine-in-just-20-lines" target="_blank">http://tech.pro/tutorial/1743/javascript-template-engine-in-just-20-lines</a>&nbsp;&nbsp;Krasimir Tsonev&nbsp;</p><br><p>[2]&nbsp;<a href="http://tangram.baidu.com/BaiduTemplate/" target="_blank">http://tangram.baidu.com/BaiduTemplate/</a>&nbsp; JS template</p>



      </div>
    </div>
    
<div class="old-article-warning">
	æœ¬æ–‡åœ¨ <b>1420</b> å¤©ä¹‹å‰å‘è¡¨ï¼ŒæŠ€æœ¯æ›´æ›¿é£å¿«ï¼Œæ–‡ä¸­éƒ¨åˆ†å†…å®¹å¯èƒ½å·²ç»è¿‡æ—¶ï¼Œå¦‚æœ‰ç–‘é—®ï¼Œ
	è¯·åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œæˆ–è€…è”ç³» <a href="/about">å°èƒ¡å­å“¥</a>ã€‚
</div>

    <div class="follow-wechat"><img src="/follow.jpg"></div>

<div class="copyright" itemscope itemtype="http://schema.org/ProfilePage" tabindex="0" aria-hidden="true">
	<!-- <a href="/about/#support" class="supportme">èµ</a> -->
	<ul>
		<li>ä½œè€…:  <a href="/about/" itemprop="name">Rain (Rain)</a></li>
		<li>å‘è¡¨æ—¥æœŸ:  2013-12-03 04:35:00</li>
		<li>æ–‡ç« åˆ†ç±»: 
	<a class="category-link" href="/categories/JavaScript/">JavaScript</a>,<a class="category-link" href="/categories/JavaScript/å‰ç«¯æ‚çƒ©/">å‰ç«¯æ‚çƒ©</a>

</li>
		<li>æ–‡ç« æ ‡ç­¾: 
<a class="article-tag-link" href="/tags/cnblogs/">cnblogs</a>, <a class="article-tag-link" href="/tags/tech/">tech</a>
</li>
		<li>ç‰ˆæƒå£°æ˜: ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç¦æ­¢æ¼”ç» 3.0 å›½é™…ï¼ˆ<a href="https://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">CC BY-NC-ND 3.0</a>ï¼‰</li>
		<li>æœ€åç¼–è¾‘æ—¶é—´: 2017-08-31 14:52:18</li>
		<li>Feedè®¢é˜…: <a href="/rss2.xml"><i class="icon">&#x25c8;</i></a></li>
	</ul>
	<a href="/about/"><img src="/blogimgs/avatar150.png" /></a>
</div>

    <em class="arrow-expend icon" tabindex="0" aria-hidden="true">&#xe618;
      <ul>
        <li><a href="/entry/">åšå®¢</a></li>
        <li><a href="/message/">é—®ç­”</a></li>
        <li><a href="/about/">å…³äº</a></li>
        <li><a href="/demo/">å®éªŒå®¤</a></li>
        <li><a href="/comments/">æœ€è¿‘è¯„è®º</a></li>
        <li><a href="/friends/">å‹æƒ…é“¾æ¥</a></li>
      </ul>
    </em>
  </div>
  <div class="post-relative">
<div class="page-relative">
  
    <a href="/all/20131206/101400/" class="post-prev">
      <i class="icon" tabindex="0" aria-hidden="true">&#x261c;</i>
      <span class="aria-readonly">ä¸Šä¸€ç¯‡æ–‡ç« </span>
      
        <b>PJAXçš„å®ç°ä¸åº”ç”¨</b>
      
    </a>
  
  
    <a href="/all/20131128/094600/" class="post-next">
      <span class="aria-readonly">ä¸‹ä¸€ç¯‡æ–‡ç« </span>
      <b>ECMAScript 6ä¸­çš„letå’Œconstå…³é”®è¯</b>
      <i class="icon" tabindex="0" aria-hidden="true">&#xe602;</i>
    </a>
  
</div>


<div class="page-relative-fixed" tabindex="0" aria-hidden="true">
  
  <a href="/all/20131206/101400/" class="prev" title="PJAXçš„å®ç°ä¸åº”ç”¨">
    <i class="icon">&#xe600;</i>
    
    <b>PJAXçš„å®ç°ä¸åº”ç”¨</b>
    
  </a>
  
  
  <a href="/all/20131128/094600/" class="next" title="ECMAScript 6ä¸­çš„letå’Œconstå…³é”®è¯">
    <i class="icon">&#x261e;</i>
    <b>ECMAScript 6ä¸­çš„letå’Œconstå…³é”®è¯</b>
  </a>
  
</div>
</div>
</div>
<div class="sidebar" tabindex="0" aria-hidden="true">
	<div class="func-btns func-btns-up">
    <span class="func-item">
        <i class="func-nav icon">&#xe618;<span>ç›®å½•</span></i>
        <div>
          <i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <a href="javascript:void(0);" onclick="return false;">æ˜¾ç¤ºç›®å½•</a>
        </div>
    </span>
    <span class="func-item">
        <i class="func-font icon">&#xe604;<span>è®¾ç½®</span></i>
        <div class="font-choose-box">
          <i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <div class="font-choose bg-choose">
            <a href="javascript:void(0)" onclick="return false;" class="bg-type bg-type-sun font-type-song"><i class="icon">&#xe61a;</i></a>
            <a href="javascript:void(0)" onclick="return false;" class="bg-type bg-type-moon font-type-hei"><i class="icon">&#xe619;</i></a>
          </div>
          <div class="font-choose">
            <a href="javascript:void(0)" onclick="return false;" class="font-type font-type-song">é»‘ä½“</a>
            <a href="javascript:void(0)" onclick="return false;" class="font-type font-type-hei">å®‹ä½“</a>
          </div>
        </div>
    </span>
    <span class="func-item">
        <a href="http://weibo.com/173248656" target="_blank"><i class="func-fb icon">åš<span>åˆ†äº«</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p class="seperator sharecanvas"><a href="javascript: void(0);">æˆªå±åˆ†äº«</a></p>
          <p><a href="http://weibo.com/173248656" target="_blank">å¾®åšå…³æ³¨</a></p>
        </div>
    </span>
    <span class="func-item">
        <i class="func-about icon">&#x263b;<span>å…³äº</span></i>
        <div>
          <i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p><a href="/about/" class="func-about-link" target="_blank">å…³äºä½œè€…</a></p>
          <div id="followMeOnWeibo"></div>
        </div>
    </span>
	</div>
	<div class="func-btns">
    <span class="func-item">
        <a href="http://demo.barretlee.com" target="_blank"><i class="func-rss icon">&#xe603;<span>å®éªŒ</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p class="seperator"><a href="http://demo.barretlee.com" target="_blank">Demoå¹³å°</a></p>
          <p class="seperator"><a href="http://md.barretlee.com" target="_blank">WXæ ¼å¼</a></p>
          <p><a href="http://snippets.barretlee.com" target="_blank">Snippetåº”ç”¨</a></p>
        </div>
    </span>
    <span class="func-item">
        <i class="func-fb icon">&#x2121;<span>ç•™è¨€</span></i>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p class="seperator"><a href="/message/" target="_blank">ç»™æˆ‘ç•™è¨€</a></p>
          <p><a href="/comments/" target="_blank">è¿‘æœŸç•™è¨€</a></p>
        </div>
    </span>
    <span class="func-item">
        <a href="/friends/" target="_blank"><i class="func-rss icon">&#xe601;<span>å‹é“¾</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <a href="/friends/" target="_blank">å‹æƒ…é“¾æ¥</a>
        </div>
    </span>
    <span class="func-item">
        <a href="/rss2.xml" target="_blank"><i class="func-rss icon">&#x25c8;<span>è®¢é˜…</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i><a href="/rss2.xml" target="_blank">è®¢é˜…æˆ‘å§ï¼</a></div>
    </span>
	</div>
</div>

<div class="single-page-footer">
<div class="footer">
	<div class="footer-wraper">
		<div class="footer-content">
			<div class="footer-nav">
	<a href="javascript: void(0);" class="ds-thread-count disqus-comment-count"
	   data-thread-key="cb-principle-of-javascript-template"
	   data-disqus-identifier="cb-principle-of-javascript-template" 
		 tabindex="0" aria-hidden="true">è¯„è®ºå†…å®¹</a>
	<a href="javascript: void(0);" id="comments">ç›¸å…³æ–‡ç« </a>
	<a href="/friends/" tabindex="0" aria-hidden="true">å‹æƒ…é“¾æ¥</a>
</div>
<div class="nav-detail">
	<div tabindex="0" aria-hidden="true">
		
<div id="SOHUCS" sid="cb-principle-of-javascript-template">
	<div class="ds-loading">
		<img src="/blogimgs/loading.gif" alt="loading..."/>
		<p>è¿™ç½‘é€ŸçœŸæ˜¯å¼±çˆ†äº†...å®¢å®˜ç¨ç­‰,è¯„è®ºè¿˜åœ¨åŠ è½½~</p>
	</div>
</div>
<script charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/changyan.js" ></script>
<script type="text/javascript">
window.changyan.api.config({
  appid: 'cyt0XnPCt',
  conf: 'prod_5fde9cb8b23a2209a1ad60ab2dd5fe82'
});
</script>

	</div>
	<div style="display:block;">
		<div class="relative-to-comment" tabindex="0" aria-hidden="true"><span>æ‰“å¼€è¯„è®º</span></div>
		<div class="relative-wrapper">
	<div class="relative-article">
		
		<ul>
			<li>
				<span><font aria-hidden="true">2017-06-06 Â»</font> </span>
				<a href="/all/20170606/144621/">æ·±å…¥ç†è§£ Node Stream å†…éƒ¨æœºåˆ¶</a>
				<span class="aria-readonly">å‘è¡¨æ—¶é—´ä¸º2017å¹´06æœˆ06æ—¥</span>
				<div class="relative-box">
          <a href="/all/20170606/144621/" class="relative-img-wrapper" style="background-image:url(/blogimgs/node-stream-readable-flowing.png);"></a>
          <span class="aria-readonly">æ–‡ç« æ¦‚è¦ </span>ç›¸ä¿¡å¾ˆå¤šäººå¯¹ Node çš„ Stream å·²ç»ä¸é™Œç”Ÿäº†ï¼Œä¸è®ºæ˜¯è¯·æ±‚æµã€å“åº”æµã€æ–‡ä»¶æµè¿˜æ˜¯ socke...
        </div>
			</li>
			
			<li>
				<span><font aria-hidden="true">2016-09-28 Â»</font> </span>
				<a href="/all/20160928/230523/">æ­ç§˜ 0.1 + 0.2 != 0.3</a>
				<span class="aria-readonly">å‘è¡¨æ—¶é—´ä¸º2016å¹´09æœˆ28æ—¥</span>
				<div class="relative-box">
          <a href="/all/20160928/230523/" class="relative-img-wrapper" style="background-image:url(http://ww4.sinaimg.cn/large/6c0378f8gw1f89pd8hm96j20p00dwacm.jpg);"></a>
          <span class="aria-readonly">æ–‡ç« æ¦‚è¦ </span>â€œ0.1 + 0.2 = ?â€ï¼Œè¿™é“é¢˜å¦‚æœç»™å°å­¦ç”Ÿï¼Œä»–ä¼šç«‹é©¬å‘Šè¯‰ä½ ç­”æ¡ˆæ˜¯ 0.3ï¼Œä½†æ˜¯äº¤ç»™ä¸€äº›ç¨‹åºå»è®¡ç®—ï¼Œç»“æœå°±ä¸æ˜¯é‚£ä¹ˆç®€å•äº†ã€‚
        </div>
			</li>
			
			<li>
				<span><font aria-hidden="true">2016-08-23 Â»</font> </span>
				<a href="/all/20160823/010513/">æ„å»ºä¸€ä¸ªå®‰å…¨çš„ JavaScript æ²™ç®±</a>
				<span class="aria-readonly">å‘è¡¨æ—¶é—´ä¸º2016å¹´08æœˆ23æ—¥</span>
				<div class="relative-box">
          <a href="/all/20160823/010513/" class="relative-img-wrapper" style="background-image:url(http://ww1.sinaimg.cn/large/6c0378f8gw1f730uldkfrj20p00dwaf1.jpg);"></a>
          <span class="aria-readonly">æ–‡ç« æ¦‚è¦ </span>åœ¨ Node.js ä¸­æœ‰ä¸€ä¸ªæ¨¡å—å«åš VMï¼Œå®ƒæä¾›äº†å‡ ä¸ª APIï¼Œå…è®¸ä»£ç åœ¨ V8 è™šæ‹Ÿæœºä¸Šä¸‹æ–‡ä¸­è¿è¡Œï¼Œå¦‚ï¼š12345const vm = require('vm');const sandbox = &#123; a: 1, b: 2 &#125;;const script = new vm.Script('a + b');const context = new vm.createContext(sandbox);script.runInContext(context);vm.Script ä¸­çš„ä»£ç æ˜¯é¢„ç¼–è¯‘å¥½çš„ï¼Œé€šè¿‡ vm.createContext å°†ä»£ç åŠ è½½åˆ°ä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œç½®å…¥æ²™ç®±ï¼ˆsandboxï¼‰ï¼Œç„¶åé€šè¿‡ script.runInContext æ‰§è¡Œä»£ç ï¼Œæ•´ä¸ªæ“ä½œéƒ½åœ¨å°é—­çš„ VM ä¸­è¿›è¡Œã€‚è¿™æ˜¯ Node.js æä¾›ç»™æˆ‘ä»¬çš„ä¾¿æ·åŠŸèƒ½ï¼Œé‚£ä¹ˆï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­å‘¢ï¼Ÿæ˜¯å¦ä¹Ÿèƒ½åšåˆ°å°†ä»£ç è¿è¡Œåœ¨æ²™ç®±ä¸­ï¼Ÿæœ¬æ–‡å¸¦ç€å¤§å®¶æ¥æ¢ç´¢ä¸€ç•ªã€‚
        </div>
			</li>
			
			<li>
				<span><font aria-hidden="true">2016-07-13 Â»</font> </span>
				<a href="/all/20160713/001549/">æˆ‘éœ€è¦å­¦ä¹  ECMAScript 6 ä¹ˆï¼Ÿ</a>
				<span class="aria-readonly">å‘è¡¨æ—¶é—´ä¸º2016å¹´07æœˆ13æ—¥</span>
				<div class="relative-box">
          <a href="/all/20160713/001549/" class="relative-img-wrapper" style="background-image:url(//ww1.sinaimg.cn/large/6c0378f8gw1f5rkudyzzoj20p00dwt9x.jpg);"></a>
          <span class="aria-readonly">æ–‡ç« æ¦‚è¦ </span>å‰å‡ å¤©ç¿»è¯‘äº†ä¸€ç¯‡ ECMAScript 6 çš„å…¥é—¨æ–‡ç« ï¼Œçœ‹åˆ°å‡ åˆ™è¯„è®ºè¯´ JavaScript è¶Šæ¥è¶Šåƒ Java äº†ï¼Œæˆ‘æš—æš—åœ°ç¬‘äº†ç¬‘ã€‚ä¹Ÿæœ‰åŒå­¦å¾ˆç–‘æƒ‘æ˜¯å¦æœ‰å¿…è¦å­¦ä¹  ES6ï¼Œä½¿ç”¨ TypeScript çš„åŒå­¦ä¹Ÿæœ‰ç±»ä¼¼çš„ç–‘æƒ‘ã€‚
        </div>
			</li>
			
		</ul>
	</div>
</div>

		<a href="/entry/" class="relative-to-comment-wrapper" tabindex="0" aria-hidden="true"><div class="relative-to-comment">å›åˆ°é¦–é¡µ</div></a>
	</div>
	<div class="friends-box">
		<ul>
			
			<li><a href="http://hustskyking.cnblogs.com" target="_blank">æ—§åšå®¢</a> <font aria-hidden="true">Â»</font> <span>æˆ‘çš„æ—§åšå®¢ï¼ˆåšå®¢å›­è£èª‰åšå®¢ï¼‰</span></li>
			
			<li><a href="http://www.zhangmengxue.com" target="_blank">å¤§é¢</a> <font aria-hidden="true">Â»</font> <span>å¤§é¢å¤§é¢å“¼æ­Œç­‰æ—¥è½</span></li>
			
			<li><a href="http://www.zhangxinxu.com" target="_blank">å¼ é‘«æ—­</a> <font aria-hidden="true">Â»</font> <span>åŸæ¥å¤§å­¦æˆ‘ä¿©ä¸€ä¸ªå›¢é˜Ÿçš„~</span></li>
			
			<li><a href="http://web-tinker.com" target="_blank">æ¬¡ç¢³é…¸é’´</a> <font aria-hidden="true">Â»</font> <span>æ·±åº¦äº¤æµçš„ä¸€ä¸ªå¥½æœ‹å‹</span></li>
			
			<li><a href="http://imququ.com" target="_blank">å±ˆå±ˆ</a> <font aria-hidden="true">Â»</font> <span>å¥½å§ï¼Œè›è›åŒå­¦</span></li>
			
			<li><a href="http://www.ruanyifeng.com" target="_blank">é˜®ä¸€å³°</a> <font aria-hidden="true">Â»</font> <span>é˜®è€å¸ˆ,å“ˆå“ˆ,ç¬¬ä¸€æ¬¡è®¾è®¡åšå®¢å°±æ˜¯æŠ„çš„ä½ çš„æ ·å¼</span></li>
			
			<li><a href="http://annn.me" target="_blank">å®‰è®°</a> <font aria-hidden="true">Â»</font> <span>é˜¿å®‰åŒå­¦</span></li>
			
			<li><a href="http://mouto.org/" target="_blank">åœåœå£</a> <font aria-hidden="true">Â»</font> <span>äºŒæ¬¡å…ƒåŒ–èº«</span></li>
			
			<li><a href="/friends/">æ›´å¤šåˆ—è¡¨ <font aria-hidden="true">Â»</font></a></li>
		</ul>
	</div>
</div>
			
<div class="website-info" aria-hidden="true">
	<a class="page_editor" href="/admin/#/posts/cj92lk7iv007x7wvvra322brl" target="_blank">ğŸ™ˆ</a>
	<span>&copy;2013-2017 <small><a href="http://www.miitbeian.gov.cn/" about="_blank">æ¹˜ICPå¤‡14007107å·-1</a></small></span>
	æœ¬ç«™ç”± <a href="/">rain</a> çº¯æ‰‹å·¥æ‰“é€  | <a href="/about#contact">è”ç³»æ–¹å¼</a> | æ€»çƒ­åº¦ï¼š<em id="busuanzi_value_site_pv"></em>
</div>

		</div>
	</div>
</div>
</div>
<div class="tools-wrapper" tabindex="0" aria-hidden="true">
	<a class="gotop icon" href="#" title="å›åˆ°é¡¶éƒ¨">&#x2191;</a>
	<!-- <a class="wechart icon">&#xe60d;<span><img src="/wechart.png" title="æ‰«ç æ·»åŠ å°èƒ¡å­å“¥å¾®ä¿¡"/> </span></a> -->
	<a class="hash-to-comments icon" title="æˆ‘è¦è¯„è®º">&#x2121;</a>
</div>
<div class="fixerr" tabindex="0" aria-hidden="true">çº é”™æ¨¡å¼</div>

</body>
<script src="/public/js/jquery.js"></script>
<script src="/public/js/socket.io.js"></script>
<script>
  window.onerror = function(e) {
    window.console && window.console.log && window.console.log(e);
    $('#loadLayer').remove();
    return true;
  };
</script>
<script src="/public/js/aplayer.js"></script>
<script src="/public/js/main.js?v=20170824"></script>
</script>
</html>
